<!DOCTYPE html>

<html>
<head>
  <title>bionode-seq</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1 id="bionode-seq">bionode-seq</h1>
<blockquote>
<p>Module for DNA, RNA and protein sequences manipulation.</p>
<p>doi: <a href="?">?</a>
author: <a href="http://bmpvieira.com">Bruno Vieira</a>
email: <a href="&#x6d;&#x61;&#x69;&#x6c;&#x74;&#111;&#58;&#109;&#97;&#x69;&#x6c;&#64;&#98;&#109;&#x70;&#x76;&#x69;&#101;&#105;&#114;&#x61;&#46;&#99;&#x6f;&#x6d;">&#109;&#97;&#x69;&#x6c;&#64;&#98;&#109;&#x70;&#x76;&#x69;&#101;&#105;&#114;&#x61;&#46;&#99;&#x6f;&#x6d;</a>
license: <a href="https://raw.githubusercontent.com/bionode/bionode-seq/master/LICENSE">MIT</a></p>
</blockquote>
<hr>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2 id="usage">Usage</h2>
<p>See the methods below.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
<span class="hljs-keyword">var</span> seq = <span class="hljs-built_in">module</span>.exports

<span class="hljs-keyword">var</span> _baseMatrix = { <span class="hljs-attr">A</span>: <span class="hljs-string">'T'</span>, <span class="hljs-attr">C</span>: <span class="hljs-string">'G'</span>, <span class="hljs-attr">W</span>: <span class="hljs-string">'S'</span>, <span class="hljs-attr">M</span>: <span class="hljs-string">'K'</span>, <span class="hljs-attr">R</span>: <span class="hljs-string">'Y'</span>, <span class="hljs-attr">B</span>: <span class="hljs-string">'V'</span>, <span class="hljs-attr">D</span>: <span class="hljs-string">'H'</span> }

<span class="hljs-keyword">var</span> _dnaComplementBasesMatrix = <span class="hljs-built_in">Object</span>.create(_baseMatrix)
<span class="hljs-keyword">var</span> _rnaComplementBasesMatrix = <span class="hljs-built_in">Object</span>.create(_baseMatrix)
<span class="hljs-keyword">var</span> _transcribeBasesMatrix = <span class="hljs-built_in">Object</span>.create(_baseMatrix)
<span class="hljs-keyword">var</span> _translateCodonsMatrix = {
  <span class="hljs-string">'GCU'</span>: <span class="hljs-string">'A'</span>, <span class="hljs-string">'GCC'</span>: <span class="hljs-string">'A'</span>, <span class="hljs-string">'GCA'</span>: <span class="hljs-string">'A'</span>, <span class="hljs-string">'GCG'</span>: <span class="hljs-string">'A'</span>, <span class="hljs-string">'CGU'</span>: <span class="hljs-string">'R'</span>, <span class="hljs-string">'CGC'</span>: <span class="hljs-string">'R'</span>,
  <span class="hljs-string">'CGA'</span>: <span class="hljs-string">'R'</span>, <span class="hljs-string">'CGG'</span>: <span class="hljs-string">'R'</span>, <span class="hljs-string">'AGA'</span>: <span class="hljs-string">'R'</span>, <span class="hljs-string">'AGG'</span>: <span class="hljs-string">'R'</span>, <span class="hljs-string">'AAU'</span>: <span class="hljs-string">'N'</span>, <span class="hljs-string">'AAC'</span>: <span class="hljs-string">'N'</span>,
  <span class="hljs-string">'GAU'</span>: <span class="hljs-string">'D'</span>, <span class="hljs-string">'GAC'</span>: <span class="hljs-string">'D'</span>, <span class="hljs-string">'UGU'</span>: <span class="hljs-string">'C'</span>, <span class="hljs-string">'UGC'</span>: <span class="hljs-string">'C'</span>, <span class="hljs-string">'CAA'</span>: <span class="hljs-string">'Q'</span>, <span class="hljs-string">'CAG'</span>: <span class="hljs-string">'Q'</span>,
  <span class="hljs-string">'GAA'</span>: <span class="hljs-string">'E'</span>, <span class="hljs-string">'GAG'</span>: <span class="hljs-string">'E'</span>, <span class="hljs-string">'GGU'</span>: <span class="hljs-string">'G'</span>, <span class="hljs-string">'GGC'</span>: <span class="hljs-string">'G'</span>, <span class="hljs-string">'GGA'</span>: <span class="hljs-string">'G'</span>, <span class="hljs-string">'GGG'</span>: <span class="hljs-string">'G'</span>,
  <span class="hljs-string">'CAU'</span>: <span class="hljs-string">'H'</span>, <span class="hljs-string">'CAC'</span>: <span class="hljs-string">'H'</span>, <span class="hljs-string">'AUU'</span>: <span class="hljs-string">'I'</span>, <span class="hljs-string">'AUC'</span>: <span class="hljs-string">'I'</span>, <span class="hljs-string">'AUA'</span>: <span class="hljs-string">'I'</span>, <span class="hljs-string">'UUA'</span>: <span class="hljs-string">'L'</span>,
  <span class="hljs-string">'UUG'</span>: <span class="hljs-string">'L'</span>, <span class="hljs-string">'CUU'</span>: <span class="hljs-string">'L'</span>, <span class="hljs-string">'CUC'</span>: <span class="hljs-string">'L'</span>, <span class="hljs-string">'CUA'</span>: <span class="hljs-string">'L'</span>, <span class="hljs-string">'CUG'</span>: <span class="hljs-string">'L'</span>, <span class="hljs-string">'AAA'</span>: <span class="hljs-string">'K'</span>,
  <span class="hljs-string">'AAG'</span>: <span class="hljs-string">'K'</span>, <span class="hljs-string">'AUG'</span>: <span class="hljs-string">'M'</span>, <span class="hljs-string">'UUU'</span>: <span class="hljs-string">'F'</span>, <span class="hljs-string">'UUC'</span>: <span class="hljs-string">'F'</span>, <span class="hljs-string">'CCU'</span>: <span class="hljs-string">'P'</span>, <span class="hljs-string">'CCC'</span>: <span class="hljs-string">'P'</span>,
  <span class="hljs-string">'CCA'</span>: <span class="hljs-string">'P'</span>, <span class="hljs-string">'CCG'</span>: <span class="hljs-string">'P'</span>, <span class="hljs-string">'UCU'</span>: <span class="hljs-string">'S'</span>, <span class="hljs-string">'UCC'</span>: <span class="hljs-string">'S'</span>, <span class="hljs-string">'UCA'</span>: <span class="hljs-string">'S'</span>, <span class="hljs-string">'UCG'</span>: <span class="hljs-string">'S'</span>,
  <span class="hljs-string">'AGU'</span>: <span class="hljs-string">'S'</span>, <span class="hljs-string">'AGC'</span>: <span class="hljs-string">'S'</span>, <span class="hljs-string">'ACU'</span>: <span class="hljs-string">'T'</span>, <span class="hljs-string">'ACC'</span>: <span class="hljs-string">'T'</span>, <span class="hljs-string">'ACA'</span>: <span class="hljs-string">'T'</span>, <span class="hljs-string">'ACG'</span>: <span class="hljs-string">'T'</span>,
  <span class="hljs-string">'UGG'</span>: <span class="hljs-string">'W'</span>, <span class="hljs-string">'UAU'</span>: <span class="hljs-string">'Y'</span>, <span class="hljs-string">'UAC'</span>: <span class="hljs-string">'Y'</span>, <span class="hljs-string">'GUU'</span>: <span class="hljs-string">'V'</span>, <span class="hljs-string">'GUC'</span>: <span class="hljs-string">'V'</span>, <span class="hljs-string">'GUA'</span>: <span class="hljs-string">'V'</span>,
  <span class="hljs-string">'GUG'</span>: <span class="hljs-string">'V'</span>, <span class="hljs-string">'UAA'</span>: <span class="hljs-string">'*'</span>, <span class="hljs-string">'UGA'</span>: <span class="hljs-string">'*'</span>, <span class="hljs-string">'UAG'</span>: <span class="hljs-string">'*'</span>, <span class="hljs-string">'XAA'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XAC'</span>: <span class="hljs-string">'X'</span>,
  <span class="hljs-string">'XAG'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XAU'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XCA'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XCC'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XCG'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XCU'</span>: <span class="hljs-string">'X'</span>,
  <span class="hljs-string">'XGA'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XGC'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XGG'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XGU'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XUA'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XUC'</span>: <span class="hljs-string">'X'</span>,
  <span class="hljs-string">'XUG'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XUU'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XAX'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XCX'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XGX'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XUX'</span>: <span class="hljs-string">'X'</span>,
  <span class="hljs-string">'XXA'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XXC'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XXG'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XXU'</span>: <span class="hljs-string">'X'</span>, <span class="hljs-string">'XXX'</span>: <span class="hljs-string">'X'</span>,
  <span class="hljs-string">'gcu'</span>: <span class="hljs-string">'a'</span>, <span class="hljs-string">'gcc'</span>: <span class="hljs-string">'a'</span>, <span class="hljs-string">'gca'</span>: <span class="hljs-string">'a'</span>, <span class="hljs-string">'gcg'</span>: <span class="hljs-string">'a'</span>, <span class="hljs-string">'cgu'</span>: <span class="hljs-string">'r'</span>, <span class="hljs-string">'cgc'</span>: <span class="hljs-string">'r'</span>,
  <span class="hljs-string">'cga'</span>: <span class="hljs-string">'r'</span>, <span class="hljs-string">'cgg'</span>: <span class="hljs-string">'r'</span>, <span class="hljs-string">'aga'</span>: <span class="hljs-string">'r'</span>, <span class="hljs-string">'agg'</span>: <span class="hljs-string">'r'</span>, <span class="hljs-string">'aau'</span>: <span class="hljs-string">'n'</span>, <span class="hljs-string">'aac'</span>: <span class="hljs-string">'n'</span>,
  <span class="hljs-string">'gau'</span>: <span class="hljs-string">'d'</span>, <span class="hljs-string">'gac'</span>: <span class="hljs-string">'d'</span>, <span class="hljs-string">'ugu'</span>: <span class="hljs-string">'c'</span>, <span class="hljs-string">'ugc'</span>: <span class="hljs-string">'c'</span>, <span class="hljs-string">'caa'</span>: <span class="hljs-string">'q'</span>, <span class="hljs-string">'cag'</span>: <span class="hljs-string">'q'</span>,
  <span class="hljs-string">'gaa'</span>: <span class="hljs-string">'e'</span>, <span class="hljs-string">'gag'</span>: <span class="hljs-string">'e'</span>, <span class="hljs-string">'ggu'</span>: <span class="hljs-string">'g'</span>, <span class="hljs-string">'ggc'</span>: <span class="hljs-string">'g'</span>, <span class="hljs-string">'gga'</span>: <span class="hljs-string">'g'</span>, <span class="hljs-string">'ggg'</span>: <span class="hljs-string">'g'</span>,
  <span class="hljs-string">'cau'</span>: <span class="hljs-string">'h'</span>, <span class="hljs-string">'cac'</span>: <span class="hljs-string">'h'</span>, <span class="hljs-string">'auu'</span>: <span class="hljs-string">'i'</span>, <span class="hljs-string">'auc'</span>: <span class="hljs-string">'i'</span>, <span class="hljs-string">'aua'</span>: <span class="hljs-string">'i'</span>, <span class="hljs-string">'uua'</span>: <span class="hljs-string">'l'</span>,
  <span class="hljs-string">'uug'</span>: <span class="hljs-string">'l'</span>, <span class="hljs-string">'cuu'</span>: <span class="hljs-string">'l'</span>, <span class="hljs-string">'cuc'</span>: <span class="hljs-string">'l'</span>, <span class="hljs-string">'cua'</span>: <span class="hljs-string">'l'</span>, <span class="hljs-string">'cug'</span>: <span class="hljs-string">'l'</span>, <span class="hljs-string">'aaa'</span>: <span class="hljs-string">'k'</span>,
  <span class="hljs-string">'aag'</span>: <span class="hljs-string">'k'</span>, <span class="hljs-string">'aug'</span>: <span class="hljs-string">'m'</span>, <span class="hljs-string">'uuu'</span>: <span class="hljs-string">'f'</span>, <span class="hljs-string">'uuc'</span>: <span class="hljs-string">'f'</span>, <span class="hljs-string">'ccu'</span>: <span class="hljs-string">'p'</span>, <span class="hljs-string">'ccc'</span>: <span class="hljs-string">'p'</span>,
  <span class="hljs-string">'cca'</span>: <span class="hljs-string">'p'</span>, <span class="hljs-string">'ccg'</span>: <span class="hljs-string">'p'</span>, <span class="hljs-string">'ucu'</span>: <span class="hljs-string">'s'</span>, <span class="hljs-string">'ucc'</span>: <span class="hljs-string">'s'</span>, <span class="hljs-string">'uca'</span>: <span class="hljs-string">'s'</span>, <span class="hljs-string">'ucg'</span>: <span class="hljs-string">'s'</span>,
  <span class="hljs-string">'agu'</span>: <span class="hljs-string">'s'</span>, <span class="hljs-string">'agc'</span>: <span class="hljs-string">'s'</span>, <span class="hljs-string">'acu'</span>: <span class="hljs-string">'t'</span>, <span class="hljs-string">'acc'</span>: <span class="hljs-string">'t'</span>, <span class="hljs-string">'aca'</span>: <span class="hljs-string">'t'</span>, <span class="hljs-string">'acg'</span>: <span class="hljs-string">'t'</span>,
  <span class="hljs-string">'ugg'</span>: <span class="hljs-string">'w'</span>, <span class="hljs-string">'uau'</span>: <span class="hljs-string">'y'</span>, <span class="hljs-string">'uac'</span>: <span class="hljs-string">'y'</span>, <span class="hljs-string">'guu'</span>: <span class="hljs-string">'v'</span>, <span class="hljs-string">'guc'</span>: <span class="hljs-string">'v'</span>, <span class="hljs-string">'gua'</span>: <span class="hljs-string">'v'</span>,
  <span class="hljs-string">'gug'</span>: <span class="hljs-string">'v'</span>, <span class="hljs-string">'uaa'</span>: <span class="hljs-string">'*'</span>, <span class="hljs-string">'uga'</span>: <span class="hljs-string">'*'</span>, <span class="hljs-string">'uag'</span>: <span class="hljs-string">'*'</span>, <span class="hljs-string">'xaa'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xac'</span>: <span class="hljs-string">'x'</span>,
  <span class="hljs-string">'xag'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xau'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xca'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xcc'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xcg'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xcu'</span>: <span class="hljs-string">'x'</span>,
  <span class="hljs-string">'xga'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xgc'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xgg'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xgu'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xua'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xuc'</span>: <span class="hljs-string">'x'</span>,
  <span class="hljs-string">'xug'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xuu'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xax'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xcx'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xgx'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xux'</span>: <span class="hljs-string">'x'</span>,
  <span class="hljs-string">'xxa'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xxc'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xxg'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xxu'</span>: <span class="hljs-string">'x'</span>, <span class="hljs-string">'xxx'</span>: <span class="hljs-string">'x'</span>
}

_rnaComplementBasesMatrix[<span class="hljs-string">'A'</span>] = <span class="hljs-string">'U'</span>
<span class="hljs-keyword">delete</span> _rnaComplementBasesMatrix[<span class="hljs-string">'T'</span>]

_transcribeBasesMatrix[<span class="hljs-string">'A'</span>] = <span class="hljs-string">'U'</span>

mirrorAndLowerCaseMatrices([
  _dnaComplementBasesMatrix,
  _rnaComplementBasesMatrix,
  _transcribeBasesMatrix
])

_transcribeBasesMatrix[<span class="hljs-string">'T'</span>] = <span class="hljs-string">'A'</span>
_transcribeBasesMatrix[<span class="hljs-string">'t'</span>] = <span class="hljs-string">'a'</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mirrorAndLowerCaseMatrices</span>(<span class="hljs-params">matricesArray</span>) </span>{
  matricesArray.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">matrix</span>) </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> k <span class="hljs-keyword">in</span> matrix) {
      <span class="hljs-keyword">var</span> v = matrix[k]
      matrix[k.toLowerCase()] = v.toLowerCase()
      matrix[v] = k
      matrix[v.toLowerCase()] = k.toLowerCase()
    }
  })
}</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h3 id="check-sequence-type">Check sequence type</h3>

            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Takes a sequence string and checks if it’s DNA, RNA or protein (returns ‘dna’, ‘rna’, ‘protein’ or undefined). Other optional arguments include threshold, length and index (see below).</p>
<pre><code>seq.checkType(<span class="hljs-string">"ATGACCCTGAGAAGAGCACCG"</span>);
=&gt; <span class="hljs-string">"dna"</span>
seq.checkType(<span class="hljs-string">"AUGACCCUGAAGGUGAAUGAA"</span>);
=&gt; <span class="hljs-string">"rna"</span>
seq.checkType(<span class="hljs-string">"MAYKSGKRPTFFEVFKAHCSDS"</span>);
=&gt; <span class="hljs-string">"protein"</span>
seq.checkType(<span class="hljs-string">"1234567891234567ATGACC"</span>);
=&gt; <span class="hljs-literal">undefined</span>
</code></pre><p>By default, the method has a 90% threshold, however, this can be altered as required.</p>
<pre><code>seq.checkType(<span class="hljs-string">"1234567891234567ATGACC"</span>, <span class="hljs-number">0.8</span>);
=&gt; <span class="hljs-literal">undefined</span>
seq.checkType(<span class="hljs-string">"--------MAYKSGKRPTFFEV"</span>, <span class="hljs-number">0.7</span>);
=&gt; <span class="hljs-string">"protein"</span>
</code></pre><p>The length value specifies the length of the sequence to be analyse (default 10000). If your sequence is extremely long, you may want to analyse a shorter sub-section to reduce the computational burden.</p>
<pre><code>seq.checkType(<span class="hljs-string">'A Very Long Sequence'</span>, <span class="hljs-number">0.9</span>, <span class="hljs-number">1000</span>);
=&gt; Type based on the first <span class="hljs-number">1000</span> characters
</code></pre><p>The index value specifies the point on the sequence from which the sequence is to be analysed. Perhaps you know that there are lot of gaps at the start of the sequence.</p>
<pre><code>seq.checkType(<span class="hljs-string">"--------MAYKSGKRPTFFEV"</span>, <span class="hljs-number">0.9</span>, <span class="hljs-number">10000</span>, <span class="hljs-number">8</span>);
=&gt; <span class="hljs-string">"protein"</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>seq.checkType = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">sequence, threshold, length, index</span>) </span>{
  <span class="hljs-keyword">if</span> (threshold === <span class="hljs-literal">undefined</span>) {
    threshold = <span class="hljs-number">0.9</span>
  }
  <span class="hljs-keyword">if</span> (length === <span class="hljs-literal">undefined</span>) {
    length = <span class="hljs-number">10000</span>
  }
  <span class="hljs-keyword">if</span> (index === <span class="hljs-literal">undefined</span>) {
    index = <span class="hljs-number">1</span>
  }
  <span class="hljs-keyword">var</span> seq = sequence.slice(index - <span class="hljs-number">1</span>, length)

  <span class="hljs-keyword">var</span> dnaSeq = seq.replace(<span class="hljs-regexp">/N/gi</span>,<span class="hljs-string">''</span>)
  <span class="hljs-keyword">var</span> dnaTotal = dnaSeq.length
  <span class="hljs-keyword">var</span> acgMatch = ((dnaSeq.match(<span class="hljs-regexp">/[ACG]/gi</span>) || []).length) / dnaTotal
  <span class="hljs-keyword">var</span> tMatch = ((dnaSeq.match(<span class="hljs-regexp">/[T]/gi</span>) || []).length) / dnaTotal
  <span class="hljs-keyword">var</span> uMatch = ((dnaSeq.match(<span class="hljs-regexp">/[U]/gi</span>) || []).length) / dnaTotal
  
  <span class="hljs-keyword">var</span> proteinSeq = seq.replace(<span class="hljs-regexp">/X/gi</span>,<span class="hljs-string">''</span>)
  <span class="hljs-keyword">var</span> proteinTotal = proteinSeq.length
  <span class="hljs-keyword">var</span> proteinMatch = ((seq.match(<span class="hljs-regexp">/[ARNDCQEGHILKMFPSTWYV\*]/gi</span>) || []).length) / proteinTotal

  <span class="hljs-keyword">if</span> (((acgMatch + tMatch) &gt;= threshold) || ((acgMatch + uMatch) &gt;= threshold)) {
    <span class="hljs-keyword">if</span> (tMatch &gt;= uMatch) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">'dna'</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (uMatch &gt;= tMatch) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">'rna'</span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-string">'dna'</span>
    }
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (proteinMatch &gt;= threshold) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'protein'</span>
  }
}</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Takes a sequence type argument and returns a function to complement bases.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>seq.createComplementBase = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sequenceType</span>) </span>{
  <span class="hljs-keyword">var</span> complementBasesMatrix = (sequenceType === <span class="hljs-string">'rna'</span> || sequenceType === <span class="hljs-string">'ambiguousRna'</span>) ? _rnaComplementBasesMatrix : _dnaComplementBasesMatrix
  <span class="hljs-keyword">var</span> getComplementBase = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">base</span>) </span>{
    <span class="hljs-keyword">var</span> complement = complementBasesMatrix[base]
    <span class="hljs-keyword">return</span> complement || base
  }
  <span class="hljs-keyword">return</span> getComplementBase
}</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <h3 id="reverse-sequence">Reverse sequence</h3>

            </div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Takes sequence string and returns the reverse sequence.</p>
<pre><code>seq.reverse(<span class="hljs-string">"ATGACCCTGAAGGTGAA"</span>);
=&gt; <span class="hljs-string">"AAGTGGAAGTCCCAGTA"</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>seq.reverse = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sequence</span>) </span>{
  <span class="hljs-keyword">return</span> sequence.split(<span class="hljs-string">''</span>).reverse().join(<span class="hljs-string">''</span>)
}</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <h3 id="-reverse-complement-sequence">(Reverse) complement sequence</h3>

            </div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Takes a sequence string and optional boolean for reverse, and returns its complement.</p>
<pre><code>seq.complement(<span class="hljs-string">"ATGACCCTGAAGGTGAA"</span>);
=&gt; <span class="hljs-string">"TACTGGGACTTCCACTT"</span>
seq.complement(<span class="hljs-string">"ATGACCCTGAAGGTGAA"</span>, <span class="hljs-literal">true</span>);
=&gt; <span class="hljs-string">"TTCACCTTCAGGGTCAT"</span>
<span class="hljs-comment">//Alias</span>
seq.reverseComplement(<span class="hljs-string">"ATGACCCTGAAGGTGAA"</span>);
=&gt; <span class="hljs-string">"TTCACCTTCAGGGTCAT"</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>seq.complement = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sequence, reverse</span>) </span>{
  <span class="hljs-keyword">var</span> reverse = reverse || <span class="hljs-literal">false</span>
  <span class="hljs-keyword">var</span> sequenceType = seq.checkType(sequence)
  <span class="hljs-keyword">var</span> getComplementBase = seq.createComplementBase(sequenceType)
  <span class="hljs-keyword">if</span> (reverse) {
    <span class="hljs-keyword">return</span> sequence.split(<span class="hljs-string">''</span>).reverse().map(getComplementBase).join(<span class="hljs-string">''</span>)
  }
  <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> sequence.split(<span class="hljs-string">''</span>).map(getComplementBase).join(<span class="hljs-string">''</span>)
  }
}</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Takes a sequence string and returns the reverse complement (syntax sugar).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>seq.reverseComplement = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sequence</span>) </span>{
  <span class="hljs-keyword">return</span> seq.complement(sequence, <span class="hljs-literal">true</span>)
}</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <h3 id="transcribe-base">Transcribe base</h3>

            </div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Takes a base character and returns the transcript base.</p>
<pre><code>seq.getTranscribedBase(<span class="hljs-string">"A"</span>);
=&gt; <span class="hljs-string">"U"</span>
seq.getTranscribedBase(<span class="hljs-string">"T"</span>);
=&gt; <span class="hljs-string">"A"</span>
seq.getTranscribedBase(<span class="hljs-string">"t"</span>);
=&gt; <span class="hljs-string">"a"</span>
seq.getTranscribedBase(<span class="hljs-string">"C"</span>);
=&gt; <span class="hljs-string">"G"</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>seq.getTranscribedBase = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">base</span>) </span>{
  <span class="hljs-keyword">return</span> _transcribeBasesMatrix[base] || base
}</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <h3 id="get-codon-amino-acid">Get codon amino acid</h3>

            </div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Takes an RNA codon and returns the translated amino acid.</p>
<pre><code>seq.getTranslatedAA(<span class="hljs-string">"AUG"</span>);
=&gt; <span class="hljs-string">"M"</span>
seq.getTranslatedAA(<span class="hljs-string">"GCU"</span>);
=&gt; <span class="hljs-string">"A"</span>
seq.getTranslatedAA(<span class="hljs-string">"CUU"</span>);
=&gt; <span class="hljs-string">"L"</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>seq.getTranslatedAA = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">codon</span>) </span>{
  <span class="hljs-keyword">return</span> _translateCodonsMatrix[codon]
}</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <h3 id="remove-introns">Remove introns</h3>

            </div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Take a sequence and an array of exonsRanges and removes them.</p>
<pre><code>seq.removeIntrons(<span class="hljs-string">"ATGACCCTGAAGGTGAATGACAG"</span>, [[<span class="hljs-number">1</span>, <span class="hljs-number">8</span>]]);
=&gt; <span class="hljs-string">"TGACCCT"</span>
seq.removeIntrons(<span class="hljs-string">"ATGACCCTGAAGGTGAATGACAG"</span>, [[<span class="hljs-number">2</span>, <span class="hljs-number">9</span>], [<span class="hljs-number">12</span>, <span class="hljs-number">20</span>]]);
=&gt; <span class="hljs-string">"GACCCTGGTGAATGA"</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>seq.removeIntrons = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sequence, exonsRanges</span>) </span>{
  <span class="hljs-keyword">var</span> sequenceWithoutIntrons = <span class="hljs-string">''</span>
  <span class="hljs-keyword">var</span> exonsRangesSorted = exonsRanges.sort(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{ <span class="hljs-keyword">return</span> a[<span class="hljs-number">0</span>] - b[<span class="hljs-number">0</span>] })
  exonsRangesSorted.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">exonRange</span>) </span>{
    sequenceWithoutIntrons += sequence.substring(exonRange[<span class="hljs-number">0</span>], exonRange[<span class="hljs-number">1</span>])
  })
  <span class="hljs-keyword">return</span> sequenceWithoutIntrons
}</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <h3 id="transcribe-sequence">Transcribe sequence</h3>

            </div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Takes a sequence string and returns the transcribed sequence (dna &lt;-&gt; rna).
If an array of exons is given, the introns will be removed from the sequence.</p>
<pre><code>seq.transcribe(<span class="hljs-string">"ATGACCCTGAAGGTGAA"</span>);
=&gt; <span class="hljs-string">"AUGACCCUGAAGGUGAA"</span>
seq.transcribe(<span class="hljs-string">"AUGACCCUGAAGGUGAA"</span>); <span class="hljs-comment">//reverse</span>
=&gt; <span class="hljs-string">"ATGACCCTGAAGGTGAA"</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>seq.transcribe = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sequence, exonsRanges</span>) </span>{
  <span class="hljs-keyword">if</span> (exonsRanges) {
    <span class="hljs-keyword">var</span> sequenceWithoutIntrons = seq.removeIntrons(sequence, exonsRanges)
    sequence = sequenceWithoutIntrons
  }
  <span class="hljs-keyword">var</span> sequenceType = seq.checkType(sequence)
  <span class="hljs-keyword">if</span> (sequenceType === <span class="hljs-string">'dna'</span> || sequenceType === <span class="hljs-string">'ambiguousDna'</span>) {
    <span class="hljs-keyword">return</span> sequence.replace(<span class="hljs-regexp">/t/g</span>, <span class="hljs-string">'u'</span>).replace(<span class="hljs-regexp">/T/g</span>, <span class="hljs-string">'U'</span>)
  }
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sequenceType === <span class="hljs-string">'rna'</span> || sequenceType === <span class="hljs-string">'ambiguousRna'</span>) {
    <span class="hljs-keyword">return</span> sequence.replace(<span class="hljs-regexp">/u/g</span>, <span class="hljs-string">'t'</span>).replace(<span class="hljs-regexp">/U/g</span>, <span class="hljs-string">'T'</span>)
  }
}</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <h3 id="translate-sequence">Translate sequence</h3>

            </div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Takes a DNA or RNA sequence and translates it to protein
If an array of exons is given, the introns will be removed from the sequence.</p>
<pre><code>seq.translate(<span class="hljs-string">"ATGACCCTGAAGGTGAATGACAGGAAGCCCAAC"</span>); <span class="hljs-comment">//dna</span>
=&gt; <span class="hljs-string">"MTLKVNDRKPN"</span>
seq.translate(<span class="hljs-string">"AUGACCCUGAAGGUGAAUGACAGGAAGCCCAAC"</span>); <span class="hljs-comment">//rna</span>
=&gt; <span class="hljs-string">"MTLKVNDRKPN"</span>
seq.translate(<span class="hljs-string">"ATGACCCTGAAGGTGAATGACAGGAAGCC"</span>, [[<span class="hljs-number">3</span>, <span class="hljs-number">21</span>]]);
=&gt; <span class="hljs-string">"LKVND"</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>seq.translate = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sequence, exonsRanges</span>) </span>{
  <span class="hljs-keyword">if</span> (exonsRanges) {
    <span class="hljs-keyword">var</span> sequenceWithoutIntrons = seq.removeIntrons(sequence, exonsRanges)
    sequence = sequenceWithoutIntrons
  }
  <span class="hljs-keyword">var</span> sequenceType = seq.checkType(sequence)
  <span class="hljs-keyword">var</span> rna
  <span class="hljs-keyword">if</span> (sequenceType === <span class="hljs-string">'protein'</span>) {
    <span class="hljs-keyword">return</span> sequence
  }
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sequenceType === <span class="hljs-string">'dna'</span> || sequenceType === <span class="hljs-string">'ambiguousDna'</span>) {
    <span class="hljs-keyword">if</span> (sequenceType === <span class="hljs-string">'ambiguousDna'</span>) sequence.replace(<span class="hljs-regexp">/[wsmkrybdhv]/g</span>, <span class="hljs-string">'x'</span>).replace(<span class="hljs-regexp">/[WSMKRYBDHV]/g</span>, <span class="hljs-string">'X'</span>)
    rna = seq.transcribe(sequence, exonsRanges)
  }
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sequenceType === <span class="hljs-string">'rna'</span> || sequenceType === <span class="hljs-string">'ambiguousRna'</span>) {
    <span class="hljs-keyword">if</span> (sequenceType === <span class="hljs-string">'ambiguousRna'</span>) sequence.replace(<span class="hljs-regexp">/[wsmkrybdhv]/g</span>, <span class="hljs-string">'x'</span>).replace(<span class="hljs-regexp">/[WSMKRYBDHV]/g</span>, <span class="hljs-string">'X'</span>)
    rna = sequence
  }
  <span class="hljs-keyword">return</span> rna.match(<span class="hljs-regexp">/.{1,3}/g</span>).map(seq.getTranslatedAA).join(<span class="hljs-string">''</span>)
}</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <h3 id="reverse-exons">Reverse exons</h3>

            </div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Takes an array of exons and the length of the reference and returns inverted coordinates.</p>
<pre><code>seq.reverseExons([[<span class="hljs-number">2</span>,<span class="hljs-number">8</span>]], <span class="hljs-number">20</span>);
=&gt; [ [ <span class="hljs-number">12</span>, <span class="hljs-number">18</span> ] ]
seq.reverseExons([[<span class="hljs-number">10</span>,<span class="hljs-number">45</span>], [<span class="hljs-number">65</span>,<span class="hljs-number">105</span>]], <span class="hljs-number">180</span>);
=&gt; [ [ <span class="hljs-number">135</span>, <span class="hljs-number">170</span> ], [ <span class="hljs-number">75</span>, <span class="hljs-number">115</span> ] ]
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>seq.reverseExons = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">exonsRanges, referenceLength</span>) </span>{
  <span class="hljs-keyword">var</span> reversedExonsRanges = []
  exonsRanges.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">exonRange</span>) </span>{
    <span class="hljs-keyword">var</span> start = referenceLength - exonRange[<span class="hljs-number">1</span>]
    <span class="hljs-keyword">var</span> stop = referenceLength - exonRange[<span class="hljs-number">0</span>]
    reversedExonsRanges.push([start, stop])
  })
  <span class="hljs-keyword">return</span> reversedExonsRanges
}</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <h3 id="find-non-canonical-splice-sites">Find non-canonical splice sites</h3>

            </div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Takes a sequence and exons ranges and returns an array of non canonical splice sites.</p>
<pre><code>seq.findNonCanonicalSplices(<span class="hljs-string">"GGCGGCGGCGGTGAGGTGGACCTGCGCGAATACGTGGTCGCCCTGT"</span>, [[<span class="hljs-number">0</span>, <span class="hljs-number">10</span>], [<span class="hljs-number">20</span>, <span class="hljs-number">30</span>]]);
=&gt; [ <span class="hljs-number">20</span> ]
seq.findNonCanonicalSplices(<span class="hljs-string">"GGCGGCGGCGGTGAGGTGAGCCTGCGCGAATACGTGGTCGCCCTGT"</span>, [[<span class="hljs-number">0</span>, <span class="hljs-number">10</span>], [<span class="hljs-number">20</span>, <span class="hljs-number">30</span>]]);
=&gt; []
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>seq.findNonCanonicalSplices = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sequence, exonsRanges</span>) </span>{
  <span class="hljs-keyword">var</span> nonCanonicalSplices = []
  <span class="hljs-keyword">var</span> exonsRangesSorted = exonsRanges.sort(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b</span>) </span>{ <span class="hljs-keyword">return</span> a[<span class="hljs-number">0</span>] - b[<span class="hljs-number">0</span>] })
  exonsRangesSorted.forEach(checkNonCanonicalIntron)
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkNonCanonicalIntron</span>(<span class="hljs-params">exonRange, i</span>) </span>{
    <span class="hljs-keyword">var</span> donor = exonRange
    <span class="hljs-keyword">var</span> acceptor = exonsRangesSorted[i + <span class="hljs-number">1</span>]
    <span class="hljs-keyword">if</span> (!acceptor) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
    <span class="hljs-keyword">var</span> intronRange = [donor[<span class="hljs-number">1</span>], acceptor[<span class="hljs-number">0</span>]]
    <span class="hljs-keyword">var</span> intronStartBases = sequence.slice(intronRange[<span class="hljs-number">0</span>], intronRange[<span class="hljs-number">0</span>] + <span class="hljs-number">2</span>).toLowerCase().replace(<span class="hljs-string">'t'</span>, <span class="hljs-string">'u'</span>)
    <span class="hljs-keyword">var</span> intronStopBases = sequence.slice(intronRange[<span class="hljs-number">1</span>] - <span class="hljs-number">2</span>, intronRange[<span class="hljs-number">1</span>]).toLowerCase()
    <span class="hljs-keyword">if</span> (intronStartBases !== <span class="hljs-string">'gu'</span>)
      nonCanonicalSplices.push(intronRange[<span class="hljs-number">0</span>])
    <span class="hljs-keyword">if</span> (intronStopBases !== <span class="hljs-string">'ag'</span>)
      nonCanonicalSplices.push(intronRange[<span class="hljs-number">1</span>])
  }
  <span class="hljs-keyword">return</span> nonCanonicalSplices
}</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <h3 id="check-canonical-translation-start-site">Check canonical translation start site</h3>

            </div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Takes a sequence and returns boolean for canonical translation start site.</p>
<pre><code>seq.checkCanonicalTranslationStartSite(<span class="hljs-string">"ATGACCCTGAAGGT"</span>);
=&gt; <span class="hljs-literal">true</span>
seq.checkCanonicalTranslationStartSite(<span class="hljs-string">"AATGACCCTGAAGGT"</span>);
=&gt; <span class="hljs-literal">false</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>seq.checkCanonicalTranslationStartSite = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sequence</span>) </span>{
  <span class="hljs-keyword">return</span> sequence.substring(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>).toLowerCase().replace(<span class="hljs-string">'t'</span>, <span class="hljs-string">'u'</span>) === <span class="hljs-string">'aug'</span>
}</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <h3 id="get-reading-frames">Get reading frames</h3>

            </div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Takes a sequence and returns an array with the six possible Reading Frames (+1, +2, +3, -1, -2, -3).</p>
<pre><code>seq.getReadingFrames(<span class="hljs-string">"ATGACCCTGAAGGTGAATGACAGGAAGCCCAAC"</span>);
=&gt; [ <span class="hljs-string">'ATGACCCTGAAGGTGAATGACAGGAAGCCCAAC'</span>,
     <span class="hljs-string">'TGACCCTGAAGGTGAATGACAGGAAGCCCAAC'</span>,
     <span class="hljs-string">'GACCCTGAAGGTGAATGACAGGAAGCCCAAC'</span>,
     <span class="hljs-string">'GTTGGGCTTCCTGTCATTCACCTTCAGGGTCAT'</span>,
     <span class="hljs-string">'TTGGGCTTCCTGTCATTCACCTTCAGGGTCAT'</span>,
     <span class="hljs-string">'TGGGCTTCCTGTCATTCACCTTCAGGGTCAT'</span> ]
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>seq.getReadingFrames = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sequence</span>) </span>{
  <span class="hljs-keyword">var</span> reverse = seq.reverseComplement(sequence)
  <span class="hljs-keyword">return</span> [sequence, sequence.substring(<span class="hljs-number">1</span>), sequence.substring(<span class="hljs-number">2</span>), reverse, reverse.substring(<span class="hljs-number">1</span>), reverse.substring(<span class="hljs-number">2</span>)]
}</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <h3 id="get-open-reading-frames">Get open reading frames</h3>

            </div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Takes a Reading Frame sequence and returns an array of Open Reading Frames.</p>
<pre><code>seq.getOpenReadingFrames(<span class="hljs-string">"ATGACCCTGAAGGTGAATGACAGGAAGCCCAAC"</span>);
=&gt; [ <span class="hljs-string">'ATGACCCTGAAGGTGAATGACAGGAAGCCCAAC'</span> ]
seq.getOpenReadingFrames(<span class="hljs-string">"AUGACCCUGAAGGUGAAUGACAGGAAGCCCAAC"</span>);
=&gt; [ <span class="hljs-string">'AUGACCCUGAAGGUGAAUGACAGGAAGCCCAAC'</span> ]
seq.getOpenReadingFrames(<span class="hljs-string">"ATGAGAAGCCCAACATGAGGACTGA"</span>);
=&gt; [ <span class="hljs-string">'ATGAGAAGCCCAACATGA'</span>, <span class="hljs-string">'GGACTGA'</span> ]
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>seq.getOpenReadingFrames = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sequence</span>) </span>{
  <span class="hljs-keyword">var</span> sequenceType = seq.checkType(sequence)
  <span class="hljs-keyword">var</span> stopCodons
  <span class="hljs-keyword">if</span> (sequenceType === <span class="hljs-string">'dna'</span> || sequenceType === <span class="hljs-string">'ambiguousDna'</span>) {
    stopCodons = [<span class="hljs-string">'TAA'</span>, <span class="hljs-string">'TGA'</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">'taa'</span>, <span class="hljs-string">'tga'</span>, <span class="hljs-string">'tag'</span>]
  }
  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sequenceType === <span class="hljs-string">'rna'</span> || sequenceType === <span class="hljs-string">'ambiguousRna'</span>) {
    stopCodons = [<span class="hljs-string">'UAA'</span>, <span class="hljs-string">'UGA'</span>, <span class="hljs-string">'UAG'</span>, <span class="hljs-string">'uaa'</span>, <span class="hljs-string">'uga'</span>, <span class="hljs-string">'uag'</span>]
  }
  <span class="hljs-keyword">var</span> openReadingFrames = []
  <span class="hljs-keyword">var</span> openReadingFrame = <span class="hljs-string">''</span>
  sequence.match(<span class="hljs-regexp">/.{1,3}/g</span>).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">codon</span>) </span>{
    openReadingFrame += codon
    <span class="hljs-keyword">if</span> (stopCodons.indexOf(codon) !== <span class="hljs-number">-1</span> &amp;&amp; openReadingFrame.length &gt; <span class="hljs-number">0</span>) {
      openReadingFrames.push(openReadingFrame)
      openReadingFrame = <span class="hljs-string">''</span>
    }
  })
  openReadingFrames.push(openReadingFrame)
  <span class="hljs-keyword">return</span> openReadingFrames
}</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <h3 id="get-all-open-reading-frames">Get all open reading frames</h3>

            </div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Takes a sequence and returns all Open Reading Frames in the six Reading Frames.</p>
<pre><code>seq.getAllOpenReadingFrames(<span class="hljs-string">"ATGACCCTGAAGGTGAATGACA"</span>);
=&gt; [ [ <span class="hljs-string">'ATGACCCTGAAGGTGAATGACA'</span> ],
     [ <span class="hljs-string">'TGA'</span>, <span class="hljs-string">'CCCTGA'</span>, <span class="hljs-string">'AGGTGA'</span>, <span class="hljs-string">'ATGACA'</span> ],
     [ <span class="hljs-string">'GACCCTGAAGGTGAATGA'</span>, <span class="hljs-string">'CA'</span> ],
     [ <span class="hljs-string">'TGTCATTCACCTTCAGGGTCAT'</span> ],
     [ <span class="hljs-string">'GTCATTCACCTTCAGGGTCAT'</span> ],
     [ <span class="hljs-string">'TCATTCACCTTCAGGGTCAT'</span> ] ]
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>seq.getAllOpenReadingFrames = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sequence</span>) </span>{
  <span class="hljs-keyword">var</span> readingFrames = seq.getReadingFrames(sequence)
  <span class="hljs-keyword">var</span> allOpenReadingFrames = readingFrames.map(seq.getOpenReadingFrames)
  <span class="hljs-keyword">return</span> allOpenReadingFrames
}</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <h3 id="find-longest-open-reading-frame">Find longest open reading frame</h3>

            </div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Takes a sequence and returns the longest ORF from all six reading frames and
corresponding frame symbol (+1, +2, +3, -1, -2, -3). If a frame symbol is specified,
only look for longest ORF on that frame.
When sorting ORFs, if there’s a tie, choose the one that starts with start codon Methionine.
If there’s still a tie, return one randomly.</p>
<pre><code>seq.findLongestOpenReadingFrame(<span class="hljs-string">"ATGACCCTGAAGGTGAATGACA"</span>);
=&gt; [ <span class="hljs-string">'ATGACCCTGAAGGTGAATGACA'</span>, <span class="hljs-string">'+1'</span> ]
seq.findLongestOpenReadingFrame(<span class="hljs-string">"ATGACCCTGAAGGTGAATGACA"</span>, <span class="hljs-string">"-1"</span>);
=&gt; <span class="hljs-string">"TGTCATTCACCTTCAGGGTCAT"</span>
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>seq.findLongestOpenReadingFrame = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sequence, frameSymbol</span>) </span>{
  <span class="hljs-keyword">var</span> frameSymbols = [<span class="hljs-string">'+1'</span>, <span class="hljs-string">'+2'</span>, <span class="hljs-string">'+3'</span>, <span class="hljs-string">'-1'</span>, <span class="hljs-string">'-2'</span>, <span class="hljs-string">'-3'</span>]
  <span class="hljs-keyword">if</span> (frameSymbol) {
    <span class="hljs-keyword">var</span> framePosition = frameSymbols.indexOf(frameSymbol)
    <span class="hljs-keyword">var</span> readingFrame = seq.getReadingFrames(sequence)[framePosition]
    <span class="hljs-keyword">var</span> openReadingFrames = seq.getOpenReadingFrames(readingFrame)
    <span class="hljs-keyword">var</span> longestOpenReadingFrame = getLongestOpenReadingFrame(openReadingFrames)
    <span class="hljs-keyword">return</span> longestOpenReadingFrame
  }
  <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Get longest ORFs for all six possible reading frames</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> longestOpenReadingFrames = seq.getAllOpenReadingFrames(sequence).map(getLongestOpenReadingFrame)</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Get longest ORF</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> longestOpenReadingFrame = getLongestOpenReadingFrame(longestOpenReadingFrames.slice())
    <span class="hljs-keyword">var</span> framePosition = longestOpenReadingFrames.indexOf(longestOpenReadingFrame)
    <span class="hljs-keyword">var</span> frameSymbol = frameSymbols[framePosition]
    <span class="hljs-keyword">return</span> [longestOpenReadingFrame, frameSymbol]
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Helper that sorts by length, giving priority to ones that start with ATG/AUG</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sortReadingFrames</span>(<span class="hljs-params">a, b</span>) </span>{
    <span class="hljs-keyword">var</span> aSort = a.length
    <span class="hljs-keyword">var</span> bSort = b.length
    <span class="hljs-keyword">if</span> (bSort - aSort === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">var</span> aStartCodon = a.slice(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>).toUpperCase().replace(<span class="hljs-string">'T'</span>, <span class="hljs-string">'U'</span>)
      <span class="hljs-keyword">var</span> bStartCodon = b.slice(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>).toUpperCase().replace(<span class="hljs-string">'T'</span>, <span class="hljs-string">'U'</span>)
      <span class="hljs-keyword">if</span> (aStartCodon === <span class="hljs-string">'AUG'</span>) { aSort++ }
      <span class="hljs-keyword">if</span> (bStartCodon === <span class="hljs-string">'AUG'</span>) { bSort++ }
    }
    <span class="hljs-keyword">return</span> bSort - aSort
  }</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Helper that takes an array and returns longest Reading Frame</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getLongestOpenReadingFrame</span>(<span class="hljs-params">array</span>) </span>{
    <span class="hljs-keyword">return</span> array.sort(sortReadingFrames)[<span class="hljs-number">0</span>]
  }

}</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
